import csv
import random
import localfunctions
import numpy
import googlemaps
import json
import datetime
import pymysql
from mysql.connector import MySQLConnection, Error

#Conexao com o cloudsql




#funcao para inserir as entradas na base de dados do Gcloud
def insert_viagens(viagens, connection,):

	query = """INSERT INTO viagens (year, hour, weekday, origincoord, originadress, destincoord, destinadress, duration, distance, fare, type) 
			VALUES(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)"""
	
	try:
		
		conn = connection
	 
		cursor = conn.cursor()
		cursor.executemany(query, viagens)
	 
		conn.commit()
	except Error as e:
		print('Error:', e)
	 
	finally:
		cursor.close()
		conn.close()


name = 'Adresses.csv'
now = datetime.datetime.now()

b = localfunctions.sorting_adresses(name,10)


origins = b[0]
destinations = b[1]

#Realizando a chamada da API para transporte publico

#APIclient = googlemaps.Client(key='AIzaSyAKFxJ5VH5mDKE-uNxDsMnahff-U84bNZ0')
APIdata = {u'status': u'OK', u'rows': [{u'elements': [{u'duration': {u'text': u'1 hour 43 mins', u'value': 6173}, u'distance': {u'text': u'35.6 km', u'value': 35605}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'2 hours 43 mins', u'value': 9758}, u'distance': {u'text': u'40.1 km', u'value': 40088}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'2 hours 21 mins', u'value': 8433}, u'distance': {u'text': u'42.2 km', u'value': 42167}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 18.23, u'text': u'R$18.23'}}, {u'duration': {u'text': u'41 mins', u'value': 2463}, u'distance': {u'text': u'6.2 km', u'value': 6176}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'1 hour 48 mins', u'value': 6498}, u'distance': {u'text': u'25.9 km', u'value': 25858}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 14.4, u'text': u'R$14.40'}}, {u'duration': {u'text': u'2 hours 10 mins', u'value': 7778}, u'distance': {u'text': u'21.5 km', u'value': 21470}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'1 hour 45 mins', u'value': 6319}, u'distance': {u'text': u'20.0 km', u'value': 20008}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 9.35, u'text': u'R$9.35'}}, {u'duration': {u'text': u'1 hour 5 mins', u'value': 3889}, u'distance': {u'text': u'8.9 km', u'value': 8879}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'2 hours 21 mins', u'value': 8489}, u'distance': {u'text': u'28.3 km', u'value': 28283}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'33 mins', u'value': 1975}, u'distance': {u'text': u'4.5 km', u'value': 4538}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}]}, {u'elements': [{u'duration': {u'text': u'2 hours 4 mins', u'value': 7455}, u'distance': {u'text': u'42.4 km', u'value': 42390}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'59 mins', u'value': 3515}, u'distance': {u'text': u'9.5 km', u'value': 9501}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'2 hours 9 mins', u'value': 7754}, u'distance': {u'text': u'33.3 km', u'value': 33287}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 12.78, u'text': u'R$12.78'}}, {u'duration': {u'text': u'2 hours 20 mins', u'value': 8399}, u'distance': {u'text': u'32.3 km', u'value': 32306}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'2 hours 21 mins', u'value': 8467}, u'distance': {u'text': u'30.2 km', u'value': 30199}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'2 hours 30 mins', u'value': 9005}, u'distance': {u'text': u'38.5 km', u'value': 38478}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 9.3, u'text': u'R$9.30'}}, {u'duration': {u'text': u'2 hours 10 mins', u'value': 7825}, u'distance': {u'text': u'32.7 km', u'value': 32731}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 12.88, u'text': u'R$12.88'}}, {u'duration': {u'text': u'2 hours 48 mins', u'value': 10108}, u'distance': {u'text': u'42.1 km', u'value': 42129}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.65, u'text': u'R$7.65'}}, {u'duration': {u'text': u'1 hour 53 mins', u'value': 6785}, u'distance': {u'text': u'15.5 km', u'value': 15517}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'2 hours 18 mins', u'value': 8308}, u'distance': {u'text': u'33.1 km', u'value': 33099}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}]}, {u'elements': [{u'duration': {u'text': u'46 mins', u'value': 2782}, u'distance': {u'text': u'12.4 km', u'value': 12433}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 10.75, u'text': u'R$10.75'}}, {u'duration': {u'text': u'1 hour 18 mins', u'value': 4670}, u'distance': {u'text': u'19.7 km', u'value': 19680}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 18.13, u'text': u'R$18.13'}}, {u'duration': {u'text': u'1 hour 10 mins', u'value': 4180}, u'distance': {u'text': u'20.9 km', u'value': 20919}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 21.2, u'text': u'R$21.20'}}, {u'duration': {u'text': u'1 hour 11 mins', u'value': 4262}, u'distance': {u'text': u'19.0 km', u'value': 18975}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'1 hour 12 mins', u'value': 4292}, u'distance': {u'text': u'16.9 km', u'value': 16939}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'1 hour 26 mins', u'value': 5166}, u'distance': {u'text': u'34.0 km', u'value': 33996}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 9.3, u'text': u'R$9.30'}}, {u'duration': {u'text': u'1 hour 8 mins', u'value': 4064}, u'distance': {u'text': u'19.0 km', u'value': 19040}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 8.85, u'text': u'R$8.85'}}, {u'duration': {u'text': u'1 hour 53 mins', u'value': 6777}, u'distance': {u'text': u'34.8 km', u'value': 34758}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.65, u'text': u'R$7.65'}}, {u'duration': {u'text': u'1 hour 18 mins', u'value': 4702}, u'distance': {u'text': u'15.3 km', u'value': 15284}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 14.95, u'text': u'R$14.95'}}, {u'duration': {u'text': u'1 hour 10 mins', u'value': 4171}, u'distance': {u'text': u'19.8 km', u'value': 19768}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}]}, {u'elements': [{u'duration': {u'text': u'1 hour 37 mins', u'value': 5838}, u'distance': {u'text': u'24.4 km', u'value': 24366}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 13.93, u'text': u'R$13.93'}}, {u'duration': {u'text': u'58 mins', u'value': 3492}, u'distance': {u'text': u'7.5 km', u'value': 7548}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'1 hour 29 mins', u'value': 5346}, u'distance': {u'text': u'23.3 km', u'value': 23258}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 9.6, u'text': u'R$9.60'}}, {u'duration': {u'text': u'2 hours 3 mins', u'value': 7392}, u'distance': {u'text': u'30.9 km', u'value': 30901}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'2 hours 6 mins', u'value': 7588}, u'distance': {u'text': u'31.5 km', u'value': 31504}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'2 hours 2 mins', u'value': 7316}, u'distance': {u'text': u'44.5 km', u'value': 44529}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 12.48, u'text': u'R$12.48'}}, {u'duration': {u'text': u'1 hour 57 mins', u'value': 7019}, u'distance': {u'text': u'34.8 km', u'value': 34847}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 12.88, u'text': u'R$12.88'}}, {u'duration': {u'text': u'2 hours 35 mins', u'value': 9295}, u'distance': {u'text': u'44.9 km', u'value': 44941}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'1 hour 45 mins', u'value': 6284}, u'distance': {u'text': u'19.8 km', u'value': 19793}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 19.65, u'text': u'R$19.65'}}, {u'duration': {u'text': u'2 hours 2 mins', u'value': 7301}, u'distance': {u'text': u'31.7 km', u'value': 31694}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}]}, {u'elements': [{u'duration': {u'text': u'1 hour 59 mins', u'value': 7126}, u'distance': {u'text': u'40.2 km', u'value': 40189}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 24.2, u'text': u'R$24.20'}}, {u'duration': {u'text': u'1 hour 58 mins', u'value': 7057}, u'distance': {u'text': u'36.6 km', u'value': 36634}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 22.05, u'text': u'R$22.05'}}, {u'duration': {u'text': u'2 hours 16 mins', u'value': 8155}, u'distance': {u'text': u'49.1 km', u'value': 49127}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 18.55, u'text': u'R$18.55'}}, {u'duration': {u'text': u'1 hour 43 mins', u'value': 6182}, u'distance': {u'text': u'21.5 km', u'value': 21471}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 13.5, u'text': u'R$13.50'}}, {u'duration': {u'text': u'2 hours 11 mins', u'value': 7835}, u'distance': {u'text': u'46.0 km', u'value': 45971}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 18.08, u'text': u'R$18.08'}}, {u'duration': {u'text': u'45 mins', u'value': 2724}, u'distance': {u'text': u'5.1 km', u'value': 5130}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'2 hours 11 mins', u'value': 7870}, u'distance': {u'text': u'47.3 km', u'value': 47255}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 18.65, u'text': u'R$18.65'}}, {u'duration': {u'text': u'1 hour 33 mins', u'value': 5573}, u'distance': {u'text': u'12.8 km', u'value': 12831}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'1 hour 9 mins', u'value': 4167}, u'distance': {u'text': u'21.9 km', u'value': 21856}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 14.9, u'text': u'R$14.90'}}, {u'duration': {u'text': u'1 hour 33 mins', u'value': 5570}, u'distance': {u'text': u'22.6 km', u'value': 22593}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 9.2, u'text': u'R$9.20'}}]}, {u'elements': [{u'duration': {u'text': u'2 hours 25 mins', u'value': 8688}, u'distance': {u'text': u'45.0 km', u'value': 44996}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 23.45, u'text': u'R$23.45'}}, {u'duration': {u'text': u'2 hours 22 mins', u'value': 8536}, u'distance': {u'text': u'41.9 km', u'value': 41926}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 20.75, u'text': u'R$20.75'}}, {u'duration': {u'text': u'2 hours 27 mins', u'value': 8803}, u'distance': {u'text': u'50.6 km', u'value': 50631}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 12.95, u'text': u'R$12.95'}}, {u'duration': {u'text': u'1 hour 58 mins', u'value': 7079}, u'distance': {u'text': u'26.7 km', u'value': 26681}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 13.75, u'text': u'R$13.75'}}, {u'duration': {u'text': u'2 hours 28 mins', u'value': 8898}, u'distance': {u'text': u'49.7 km', u'value': 49673}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 17.25, u'text': u'R$17.25'}}, {u'duration': {u'text': u'26 mins', u'value': 1589}, u'distance': {u'text': u'3.1 km', u'value': 3052}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'2 hours 27 mins', u'value': 8795}, u'distance': {u'text': u'53.7 km', u'value': 53661}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 19, u'text': u'R$19.00'}}, {u'duration': {u'text': u'1 hour 23 mins', u'value': 4953}, u'distance': {u'text': u'12.6 km', u'value': 12580}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'1 hour 36 mins', u'value': 5739}, u'distance': {u'text': u'26.2 km', u'value': 26203}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 13.6, u'text': u'R$13.60'}}, {u'duration': {u'text': u'1 hour 49 mins', u'value': 6535}, u'distance': {u'text': u'27.9 km', u'value': 27917}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 9.2, u'text': u'R$9.20'}}]}, {u'elements': [{u'duration': {u'text': u'1 hour 56 mins', u'value': 6965}, u'distance': {u'text': u'43.8 km', u'value': 43762}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 18.6, u'text': u'R$18.60'}}, {u'duration': {u'text': u'1 hour 55 mins', u'value': 6896}, u'distance': {u'text': u'40.2 km', u'value': 40207}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 16.45, u'text': u'R$16.45'}}, {u'duration': {u'text': u'2 hours 13 mins', u'value': 7994}, u'distance': {u'text': u'52.7 km', u'value': 52676}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 20.05, u'text': u'R$20.05'}}, {u'duration': {u'text': u'2 hours 4 mins', u'value': 7447}, u'distance': {u'text': u'38.1 km', u'value': 38065}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 9.3, u'text': u'R$9.30'}}, {u'duration': {u'text': u'2 hours 8 mins', u'value': 7674}, u'distance': {u'text': u'49.5 km', u'value': 49544}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 12.48, u'text': u'R$12.48'}}, {u'duration': {u'text': u'29 mins', u'value': 1732}, u'distance': {u'text': u'3.4 km', u'value': 3419}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'2 hours 8 mins', u'value': 7709}, u'distance': {u'text': u'52.1 km', u'value': 52077}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 14.7, u'text': u'R$14.70'}}, {u'duration': {u'text': u'1 hour 47 mins', u'value': 6407}, u'distance': {u'text': u'16.0 km', u'value': 16019}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'1 hour 7 mins', u'value': 4006}, u'distance': {u'text': u'25.4 km', u'value': 25429}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 9.3, u'text': u'R$9.30'}}, {u'duration': {u'text': u'1 hour 48 mins', u'value': 6478}, u'distance': {u'text': u'26.5 km', u'value': 26528}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 15, u'text': u'R$15.00'}}]}, {u'elements': [{u'duration': {u'text': u'1 hour 13 mins', u'value': 4354}, u'distance': {u'text': u'21.0 km', u'value': 21039}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 10.75, u'text': u'R$10.75'}}, {u'duration': {u'text': u'1 hour 37 mins', u'value': 5801}, u'distance': {u'text': u'27.4 km', u'value': 27352}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'37 mins', u'value': 2220}, u'distance': {u'text': u'8.6 km', u'value': 8628}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.85, u'text': u'R$4.85'}}, {u'duration': {u'text': u'1 hour 39 mins', u'value': 5937}, u'distance': {u'text': u'27.6 km', u'value': 27583}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'1 hour 35 mins', u'value': 5688}, u'distance': {u'text': u'22.6 km', u'value': 22622}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 10.4, u'text': u'R$10.40'}}, {u'duration': {u'text': u'1 hour 44 mins', u'value': 6220}, u'distance': {u'text': u'42.0 km', u'value': 42035}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 9.3, u'text': u'R$9.30'}}, {u'duration': {u'text': u'1 hour 43 mins', u'value': 6196}, u'distance': {u'text': u'30.2 km', u'value': 30191}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'2 hours 11 mins', u'value': 7831}, u'distance': {u'text': u'42.8 km', u'value': 42797}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.65, u'text': u'R$7.65'}}, {u'duration': {u'text': u'1 hour 39 mins', u'value': 5956}, u'distance': {u'text': u'25.0 km', u'value': 24951}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'1 hour 37 mins', u'value': 5846}, u'distance': {u'text': u'28.4 km', u'value': 28376}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}]}, {u'elements': [{u'duration': {u'text': u'34 mins', u'value': 2023}, u'distance': {u'text': u'3.6 km', u'value': 3628}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'1 hour 44 mins', u'value': 6217}, u'distance': {u'text': u'27.0 km', u'value': 26950}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'1 hour 20 mins', u'value': 4795}, u'distance': {u'text': u'29.7 km', u'value': 29734}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 20.9, u'text': u'R$20.90'}}, {u'duration': {u'text': u'53 mins', u'value': 3185}, u'distance': {u'text': u'15.3 km', u'value': 15293}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 10.15, u'text': u'R$10.15'}}, {u'duration': {u'text': u'1 hour 10 mins', u'value': 4188}, u'distance': {u'text': u'11.2 km', u'value': 11176}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'1 hour 43 mins', u'value': 6205}, u'distance': {u'text': u'38.1 km', u'value': 38122}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 12.48, u'text': u'R$12.48'}}, {u'duration': {u'text': u'34 mins', u'value': 2027}, u'distance': {u'text': u'6.4 km', u'value': 6375}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 5.85, u'text': u'R$5.85'}}, {u'duration': {u'text': u'2 hours 2 mins', u'value': 7332}, u'distance': {u'text': u'32.2 km', u'value': 32245}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 17, u'text': u'R$17.00'}}, {u'duration': {u'text': u'1 hour 48 mins', u'value': 6492}, u'distance': {u'text': u'24.5 km', u'value': 24548}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'52 mins', u'value': 3094}, u'distance': {u'text': u'16.1 km', u'value': 16086}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 10.15, u'text': u'R$10.15'}}]}, {u'elements': [{u'duration': {u'text': u'1 hour 21 mins', u'value': 4839}, u'distance': {u'text': u'21.4 km', u'value': 21411}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 13.33, u'text': u'R$13.33'}}, {u'duration': {u'text': u'55 mins', u'value': 3314}, u'distance': {u'text': u'8.0 km', u'value': 8027}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'1 hour 38 mins', u'value': 5905}, u'distance': {u'text': u'27.8 km', u'value': 27806}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 12.33, u'text': u'R$12.33'}}, {u'duration': {u'text': u'1 hour 44 mins', u'value': 6235}, u'distance': {u'text': u'27.8 km', u'value': 27848}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'1 hour 45 mins', u'value': 6303}, u'distance': {u'text': u'25.7 km', u'value': 25741}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'1 hour 43 mins', u'value': 6184}, u'distance': {u'text': u'36.7 km', u'value': 36692}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 12.48, u'text': u'R$12.48'}}, {u'duration': {u'text': u'1 hour 42 mins', u'value': 6143}, u'distance': {u'text': u'25.3 km', u'value': 25322}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}, {u'duration': {u'text': u'2 hours 11 mins', u'value': 7838}, u'distance': {u'text': u'38.1 km', u'value': 38077}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.65, u'text': u'R$7.65'}}, {u'duration': {u'text': u'1 hour 20 mins', u'value': 4796}, u'distance': {u'text': u'11.4 km', u'value': 11423}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 4.3, u'text': u'R$4.30'}}, {u'duration': {u'text': u'1 hour 42 mins', u'value': 6144}, u'distance': {u'text': u'28.6 km', u'value': 28641}, u'status': u'OK', u'fare': {u'currency': u'BRL', u'value': 7.48, u'text': u'R$7.48'}}]}], u'origin_addresses': [u'R. Eleazar Carpentras, 54 - Jardim Santa Adelia, S\xe3o Paulo - SP, 03977-019, Brazil', u'R. Dr. Garc\xeda, 76 - Vila Santos, S\xe3o Paulo - SP, 02637-010, Brazil', u'R. Ant\xf4nio Carlos, 268 - Consola\xe7\xe3o, S\xe3o Paulo - SP, 01309-010, Brazil', u'Av. Itaberaba, 250 - Nossa Sra. do O, S\xe3o Paulo - SP, 02675-031, Brazil', u'R. Socorozeiro, 22 - Cidade S\xe3o Miguel, S\xe3o Paulo - SP, 08042-330, Brazil', u'R. Corn\xe9lio de Arz\xe3o, 1693 - Jardim Miriam, S\xe3o Paulo - SP, 08140-550, Brazil', u'R. Manuel Bueno da Fonseca, 461 - Jardim Sao Luis (Zona Leste), S\xe3o Paulo - SP, 08121-000, Brazil', u'R. \xc9den, 496 - Jardim Dona Sinha, S\xe3o Paulo - SP, Brazil', u'R. Artur Dias, 420 - Cursino, S\xe3o Paulo - SP, 04150-070, Brazil', u'R. Bento da Concei\xe7\xe3o, 140 - Chora Menino, S\xe3o Paulo - SP, 02462-083, Brazil'], u'destination_addresses': [u'Av. Padre Arlindo Vieira, 603 - Vila Vermelha, S\xe3o Paulo - SP, 04297-000, Brazil', u'Av. General Penha Brasil, 3226a - Vila Nova Cachoeirinha, S\xe3o Paulo - SP, 02673-000, Brazil', u'Estr. Kizaemon Takeuti, 43 - Jardim Clementino, Tabo\xe3o da Serra - SP, 06775-000, Brazil', u'R. Santa Maria do Cambuc\xe1, 180 - Vila Tolstoi, S\xe3o Paulo - SP, 03268-130, Brazil', u'Rua Ant\xf4nio Agostim, 93 - Jardim Miriam, S\xe3o Paulo - SP, 04419-160, Brazil', u'Rua Jurar\xe1s, 4 - Vila Silva Teles, S\xe3o Paulo - SP, 08110-185, Brazil', u'R. Eug\xeania S\xe1 Vitale, 676 - Vila Santa Luzia, S\xe3o Bernardo do Campo - SP, 09930-380, Brazil', u'R. Jonas Barbosa Filho, 207 - Jardim Marilu, S\xe3o Paulo - SP, 08371-720, Brazil', u'R. Canhoneira Mearim, 633 - Vila Maria Alta, S\xe3o Paulo - SP, 02131-020, Brazil', u'Rua Em\xedlio Jafet Filho, 15 - Jardim Angela (Zona Leste), S\xe3o Paulo - SP, Brazil']}
datafram = []

#interpretando os resultado Json para compor uma matriz
for i in range (len(APIdata['rows'])):

	for j in range (len(APIdata['rows'][i]['elements'])):
		
		#para os casos em que a coordenada nap acha um endereco
		if APIdata['rows'][i]['elements'][j]['status'] == "OK":

			row_aux = (now.strftime("%d-%m-%Y"), now.strftime("%H:%M"), now.strftime("%A"), origins[i], APIdata['origin_addresses'][i], destinations[j], APIdata['destination_addresses'][j], int(APIdata['rows'][i]['elements'][j]['duration']['value']), int(APIdata['rows'][i]['elements'][j]['distance']['value']), 'NORESULT', 'traffic')
			
			#para os casos em que nao ha o dado tarifa 
			print (APIdata['rows'][i]['elements'][j]['fare'])
			print ('fare' in APIdata['rows'][i]['elements'][j])
			if 'fare' in APIdata['rows'][i]['elements']:
				row_aux[9] = APIdata['rows'][i]['elements'][j]['fare']['value']

		else:
			row_aux = ('NORESULTS', 'NORESULTS', 'NORESULTS','NORESULTS', 'NORESULTS','NORESULTS','NORESULTS', 0, 0, 'NORESULTS', 'NORESULTS')
		
		datafram.append(row_aux)



#Realizando a chamada da API para transporte privado







